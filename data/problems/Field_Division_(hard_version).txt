This is a hard version of the problem; it differs from the easy version only by the question. The easy version only needs you to print whether some values are non-zero or not. The hard version needs you to print the exact values.
Alice and Bob are dividing the field. The field is a rectangle of size n × m n × m ( 2 ≤ n , m ≤ 10 9 2 ≤ n , m ≤ 10 9 ); the rows are numbered from 1 1 to n n from top to bottom, and the columns are numbered from 1 1 to m m from left to right. The cell at the intersection of row r r and column c c is denoted as ( r , c r , c ).
Bob has k k ( 2 ≤ k ≤ 2 ⋅ 10 5 2 ≤ k ≤ 2 ⋅ 10 5 ) fountains, all of them are located in different cells of the field. Alice is responsible for dividing the field, but she must meet several conditions:
Alice wants to divide the field in such a way as to get as many cells as possible.
Bob wants to keep ownership of all the fountains, but he can give one of them to Alice. First, output the integer α α — the maximum possible size of Alice's plot, if Bob does not give her any fountain (i.e., all fountains will remain on Bob's plot).
Then output k k non-negative integers a 1 , a 2 , … , a k a 1 , a 2 , … , a k , where a i a i is a value such that after Bob gives Alice the i i -th fountain, the maximum size of her plot will be α + a i α + a i .