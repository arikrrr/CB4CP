Claire loves drawing lines. She receives a sheet of paper with an n × n n × n grid and begins drawing "lines" on it. Well—the concept of a "line" here is not what we usually think of. Claire refers each line to be a set of consecutive vertical grid cells. When she draws a line, these cells are all covered with black ink. Initially, all the cells are white, and drawing lines turns some of them black. After drawing a few lines, Claire wonders: how many ways she can color an additional white cell black so that the remaining white cells do not form a single connected component.

Two cells are directly connected if they share an edge. Two cells x x and y y are indirectly connected if there exists a sequence of cells c 0 , c 1 , … , c k c 0 , c 1 , … , c k with k > 1 k > 1 such that c 0 = x c 0 = x , c k = y c k = y , and for every i ∈ { 1 , 2 , … , k } i ∈ { 1 , 2 , … , k } the cells c i c i and c i − 1 c i − 1 are directly connected. A set of cells forms a single connected component if each pair of cells in the set is either directly or indirectly connected.

The grid has n n rows and n n columns, both indexed from 1 1 to n n . Claire will draw q q lines. The i i -th line is drawn in the y i y i -th column, from the s i s i -th row to the f i f i -th row, where s i ≤ f i s i ≤ f i for each i ∈ { 1 , 2 , … , q } i ∈ { 1 , 2 , … , q } . Note that the cells that are passed by at least one of the q q lines are colored black. The following figure shows an example of a 20 × 20 20 × 20 grid with q = 67 q = 67 lines. The grid cells marked with red star symbols refer to the cells such that, if Claire colors that cell black, all white cells no longer form a single connected component.

You may assume that, after drawing the q q lines, the remaining white cells form a single connected component with at least three white cells.