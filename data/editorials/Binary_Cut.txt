First, note that it's always optimal to divide the string into "blocks" of equal values; there is no use having two strings 111|11111|11 when we can just have 1111111111 and use fewer pieces.Now note that to sort the string, we need all blocks of 00 to come before all blocks of 11. The only way that two blocks can join is if we have a block of 00s before a block of 11s, and we can have at most one such block. That is, all strings look like:So the answer is the number of blocks, but we should subtract 11 if a substring 0101 exists (because then we can make the center block above). The time complexity is O(|s|)O(|s|).For example, for the string 111000110111000110, we can use three pieces: 111|00011|0→0|00011|111111|00011|0→0|00011|111.