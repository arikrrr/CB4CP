2026C - Action FiguresConsider the following solution: we iterate on the number of figures we get for free (let this number bekk), and for each value ofkk, we try to check if it is possible to getkkfigures for free, and if it is, find the best figures which we get for free.For a fixed value ofkk, it is optimal to visit the shop exactlykktimes: if we visit the shop more thankktimes, then during some visits, we buy only one figure — instead of that, we can buy figures from these visits during the last day, so there are no visits during which we buy only one figure.It is quite obvious that if we want to visit the shopkktimes, we always can do it during the lastkkdays withsi=1si=1. Let the lastkkdays withsi=1si=1bex1,x2,…,xkx1,x2,…,xk(from right to left, sox1>x2>⋯>xkx1>x2>⋯>xk). It is impossible to get a total discount of more than(x1+x2+⋯+xk)(x1+x2+⋯+xk)if we visit the shop onlykktimes, since when we visit the shop on dayii, the maximum discount we can get during that day isii.Now suppose we can't get the figures{x1,x2,…,xk}{x1,x2,…,xk}for free, but we can get some other set of figures{y1,y2,…,yk}{y1,y2,…,yk}(y1>y2>⋯>yky1>y2>⋯>yk) for free. Let's show that this is impossible. Consider the firstjjsuch thatxj≠yjxj≠yj:ifyj>xjyj>xj, it means that on some suffix of days (from dayyjyjto daynn), we visit the shopjjtimes. But sincex1,x2,…,xj−1,xjx1,x2,…,xj−1,xjare the lastjjdays when we visit the shop, then we can't visit the shopjjtimes from dayyjyjto daynn, so this is impossible;otherwise, ifyj<xjyj<xj, it means that during the dayxjxj, we get some figurefffor free, but it is notxjxj. Let's get the figurexjxjfor free during that day instead (swap the figuresffandxjxj). Using a finite number of such transformations, we can show that we can get the figures{x1,x2,…,xk}{x1,x2,…,xk}for free.Now, for a fixed value ofkk, we know which figures we should get for free. And if we increase the value ofkk, our total discount increases as well. Let's find the greatest possiblekkwith binary search, and we will get a solution working inO(nlogn)O(nlog⁡n).The only thing that's left is checking that some value ofkkis achievable. To do it, we can mark thekkfigures we try to get for free, and simulate the process, iterating the figures from left to right. If on some prefix, the number of figures we want to get for free is greater than the number of figures we pay for, then it is impossible, since we can't find a "match" for every figure we want to get for free.