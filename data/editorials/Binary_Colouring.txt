Note that one action with the cube changes the parity of the number of cubes in the tower. Therefore, if the parities of nn and mm do not match, it is impossible to build the tower. Also, if n<mn<m, the tower cannot be built either. In all other cases, it is possible to build a tower of height mm in mm operations, and then add and remove a cube until the operations are exhausted.We will iterate over the prefix of ii bits and construct a correct answer for the number formed by the prefix bits of the number xx. We are interested in considering only the one bits, as they are the only ones that affect the value of the number xx.If we have already placed a one at position ii in the answer, we need to somehow add 2i2i to the number. To do this, we simply zero out the ii-th bit in the answer and set it at i+1i+1 — this will add 2⋅2i=2i+12⋅2i=2i+1.Now, the ii-th position in the answer holds 00.Let's consider what we placed at position i−1i−1 in the answer. If it's 00, then everything is fine; we just place 11 at position ii. If it's 11, we have a situation of [1 1], which we correct by making it [-1 0 1] — placing −1−1 at i−1i−1, leaving 00 at ii, and placing 11 at i+1i+1. This will add 2i2i to the sum because 2i+2i−1=2i+1−2i−12i+2i−1=2i+1−2i−1. The remaining case is when i−1i−1 holds −1−1, but this is impossible because our forward operations only place ones, and −1−1 is placed behind.The final time complexity is O(log(x))O(log⁡(x)) per test case.